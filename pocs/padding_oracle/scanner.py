import requests
import argparse
import base64




parser = argparse.ArgumentParser()
parser.add_argument('URL', help='url')
parser.add_argument('COOKIE', help='cookiename', metavar="COOKIENAME")
parser.add_argument('PREFIX', help='prefix in hex')
parser.add_argument('SUFFIX', help='suffix in hex')
parser.add_argument('-s', '--start', help='start value', type=int, default=0)
parser.add_argument('-e', '--end', help='end value', type=int, default=255)


args = parser.parse_args()


print "value   status   length payload"
for i in range(args.start, args.end+1):
    value = "%s%02x%s" % (args.PREFIX, i, args.SUFFIX)
    value = base64.b64encode(value.decode('hex'))
    resp = requests.get(args.URL, cookies={
            args.COOKIE: value
        })

    print "%5d     %6d      %s %s" % (i, resp.status_code, resp.headers['Content-Length'], value)

