#!/usr/bin/env python
# vim: set ts=8 sw=4 tw=0 fileencoding=utf-8 filetype=python expandtab:

import cgi
import os

def send_response(body, headers=None):
    if not headers:
        headers = {}

    if 'Content-type' not in headers:
        headers['Content-type'] = 'text/html'

    for key, value in headers.items():
        for v in value:
            print("%s: %s" % (key, v))

    print("")

    print(body)


def get_cookie(name):
    if 'HTTP_COOKIE' not in os.environ:
        return None
    cookies = [cookie.strip().split('=', 1) for cookie in os.environ['HTTP_COOKIE'].split(";")]

    for cookie in cookies:
        if cookie[0] == name:
            return cookie[1]
    return None

class Headers(dict):
    def __setitem__(self, name, value):
        if name in self:
            if isinstance(self[name], list):
                value = self[name] + [value]
        else:
            value = [value]
        super(Headers, self).__setitem__(name, value)
