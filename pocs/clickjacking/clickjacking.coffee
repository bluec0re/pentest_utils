get_params = () -> 
    url = window.location.search
    params = {}
    if url.length > 1
        re_name = /^(.+?)(\[(.*)\])?$/
        url = url[1..].split('&')
        for u in url
            seg = u.split('=')
            [name, value] = for s in seg
                decodeURIComponent s.replace(/\+/g, '%20')
            name = name.match re_name
            if name[2] == undefined
                params[name[0]] = value
            else
                if params[name[1]]?
                    params[name[1]] = new Array()
                if name[3] != ""
                    params[name[1]][name[3]] = value
                else
                    params[name[1]].push value
    params


get_mouse = (e = window.event) ->
    pos =
        x: 0
        y: 0
    if e.pageX? and e.pageY?
        pos =
            x: e.pageX
            y: e.pageY
    else if e.clientX? and e.clientY?
        pos = 
            x: e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft
            y: e.clientY + document.body.scrollTop + document.documentElement.scrollTop
    pos


$ = (id) ->
    document.getElementById id
$$ = (sel) ->
    document.querySelectorAll sel


window.onload = () ->
    $('fakeBtn').onclick = () ->
        alert 'Clickjacking failed :('
    
    params = get_params()
    url = params.url
    xpos = params.x
    ypos = params.y
    debug = params.debug

    if not url?
        url = prompt "URL to clickjack"
