package eu.bluec0re.burp;

import java.util.List;
import java.net.URLEncoder;

public class Form {
    private String name;
    private String action;
    private String method;
    private List<Parameter> parameters;

    public Form(String name, String action, String method, List<Parameter> parameters) {
        this.name = name;
        this.action = action;
        this.method = method;
        this.parameters = parameters;
    }

    public String getName() {
        return name;
    }

    public String getAction() {
        return action;
    }

    public String getMethod() {
        return method;
    }

    public List<Parameter> getParameters() {
        return parameters;
    }

    public String getData() {
        StringBuilder data = new StringBuilder();
        for(Parameter p : getParameters()) {
            try {
                if(p.getName() == null)
                    continue;
                data.append(URLEncoder.encode(p.getName().toString(), "UTF-8"));
                data.append('=');
                if(p.getValue() != null)
                    data.append(URLEncoder.encode(p.getValue().toString(), "UTF-8"));
                data.append('&');
            } catch(java.io.UnsupportedEncodingException e) {}
        }
        if(data.length() > 1)
            data.deleteCharAt(data.length()-1);
        return data.toString();
    }
}
